"use strict";var refs={removeButton:document.querySelector(".remove"),cardTemplate:document.querySelector(".cardTemplate"),cardsHolder:document.querySelector(".Cards"),inputurl:document.querySelector("#InputURl"),addButton:document.querySelector(".addButton")},LOCALSTORAGE=function(e){if(e){return{isActive:"localStorage"in e,get:function(e){try{var r=localStorage.getItem(e);return null===r?void 0:JSON.parse(r)}catch(e){console.error("Get state error: ",e)}},set:function(e,r){try{var t=JSON.stringify(r);localStorage.setItem(e,t)}catch(e){console.error("Set state error: ",e)}}}}}(window);console.log(LOCALSTORAGE);var displayCards=function(e,r,t){console.log(r,t),t.innerHTML="";var a=r.innerHTML.trim(),n=Handlebars.compile(a),o=e.reduce(function(e,r){return e+n(r)},"");t.innerHTML=o},arrCards=[],linkPreview=function(e){fetch("http://api.linkpreview.net/?key=5bb905e4709c07d0c5dcce206d1a180df48ebcbd42e33&q="+e).then(function(e){return e.json()}).then(function(r){console.log(r.url),0!==arrCards.length&&arrCards.find(function(e){return e.url===r.url})?alert("такая закладка уже есть"):(arrCards.unshift(r),LOCALSTORAGE.set("fecaon06|"+r.url,r),displayCards.call(document,arrCards,refs.cardTemplate,refs.cardsHolder))}).catch(function(e){return console.log(e)})},removeCard=function(e){var r=e.target,t=r.nodeName,a=r.classList.contains("remove");if("BUTTON"===t||a){var n=r.parentNode.querySelector("span").textContent.replace("URL: ",""),o=arrCards.findIndex(function(e){if(n===e.url)return!0});arrCards.splice(o,1),localStorage.removeItem("fecaon06|"+n),displayCards(arrCards,refs.cardTemplate,refs.cardsHolder)}};for(var key in localStorage)key.includes("fecaon06|")&&arrCards.push(JSON.parse(localStorage.getItem(key)));displayCards(arrCards,refs.cardTemplate,refs.cardsHolder),refs.addButton.addEventListener("click",function(){linkPreview(refs.inputurl.value),refs.inputurl.value=""}),refs.cardsHolder.addEventListener("click",removeCard.bind(void 0));